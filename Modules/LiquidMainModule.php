<?php declare(strict_types = 1);

/*  Idea (c) 2023 Nikita Zhavoronkov, nikzh@nikzh.com
 *  Copyright (c) 2023 3xpl developers, 3@3xpl.com, see CONTRIBUTORS.md
 *  Distributed under the MIT software license, see LICENSE.md  */

/*  This is the assets Liquid Bitcoin module.
 *  Using AssetRegistry: https://docs.liquid.net/docs/blockstream-liquid-asset-registry
 * */

final class LiquidMainModule extends UTXOLiquidModule implements Module
{
    function initialize()
    {
        // CoreModule
        $this->blockchain = 'liquid';
        $this->module = 'liquid-main';
        $this->is_main = true;
        $this->first_block_date = '2018-09-27';

        // Liquid-specific
        $this->native_asset = '6f0279e9ed041c3d710a9f57d0c02928416460c4b722ae3457a11eec381c526d';
        $this->native_asset_meta = ['name' => 'Liquid Bitcoin', 'ticker' => 'L-BTC', 'precision' => 8];

        // Tests
        $this->tests = [
            // With currency
            ['block' => 2774298, 'result' => 'a:2:{s:6:"events";a:8:{i:0;a:9:{s:11:"transaction";s:64:"f318eda796f0dce947fb18a21fc4cfeeaee7dedc83989e3721aa09c82760b32f";s:8:"currency";s:64:"6f0279e9ed041c3d710a9f57d0c02928416460c4b722ae3457a11eec381c526d";s:7:"address";s:8:"the-void";s:6:"effect";s:3:"-60";s:5:"extra";N;s:13:"extra_indexed";N;s:5:"block";i:2774298;s:4:"time";s:19:"2024-03-18 20:38:08";s:8:"sort_key";i:0;}i:1;a:9:{s:11:"transaction";s:64:"f318eda796f0dce947fb18a21fc4cfeeaee7dedc83989e3721aa09c82760b32f";s:8:"currency";s:64:"6f0279e9ed041c3d710a9f57d0c02928416460c4b722ae3457a11eec381c526d";s:7:"address";s:39:"script-58f7fda4425dd61e07568702c58b3fc2";s:6:"effect";s:1:"0";s:5:"extra";N;s:13:"extra_indexed";N;s:5:"block";i:2774298;s:4:"time";s:19:"2024-03-18 20:38:08";s:8:"sort_key";i:1;}i:2;a:9:{s:11:"transaction";s:64:"f318eda796f0dce947fb18a21fc4cfeeaee7dedc83989e3721aa09c82760b32f";s:8:"currency";s:64:"6f0279e9ed041c3d710a9f57d0c02928416460c4b722ae3457a11eec381c526d";s:7:"address";s:34:"QLFdUboUPJnUzvsXKu83hUtrQ1DuxyggRg";s:6:"effect";s:2:"60";s:5:"extra";N;s:13:"extra_indexed";N;s:5:"block";i:2774298;s:4:"time";s:19:"2024-03-18 20:38:08";s:8:"sort_key";i:2;}i:3;a:9:{s:11:"transaction";s:64:"f318eda796f0dce947fb18a21fc4cfeeaee7dedc83989e3721aa09c82760b32f";s:8:"currency";s:64:"6f0279e9ed041c3d710a9f57d0c02928416460c4b722ae3457a11eec381c526d";s:7:"address";s:39:"script-95baa1886566d84b5271a295d3a773b3";s:6:"effect";s:1:"0";s:5:"extra";N;s:13:"extra_indexed";N;s:5:"block";i:2774298;s:4:"time";s:19:"2024-03-18 20:38:08";s:8:"sort_key";i:3;}i:4;a:9:{s:11:"transaction";s:64:"97d3a20cb85209167de9ff354be7a6b7f10506db35a7ca5dfeae81cdfce73433";s:8:"currency";s:64:"6f0279e9ed041c3d710a9f57d0c02928416460c4b722ae3457a11eec381c526d";s:7:"address";s:42:"ex1qpwdf7qxr5tg0amtz8xwfha9wclmhkahyypc9gr";s:6:"effect";s:8:"-1134077";s:5:"extra";N;s:13:"extra_indexed";N;s:5:"block";i:2774298;s:4:"time";s:19:"2024-03-18 20:38:08";s:8:"sort_key";i:4;}i:5;a:9:{s:11:"transaction";s:64:"97d3a20cb85209167de9ff354be7a6b7f10506db35a7ca5dfeae81cdfce73433";s:8:"currency";s:64:"71e30c59c03e78d064757befa459ae7a0e9c4b8a5ae16cc90b3d70fc73b40ce4";s:7:"address";s:42:"ex1qh59jvreqevgl2jwrx325zcp5lmdksaettgr62h";s:6:"effect";s:9:"101899500";s:5:"extra";N;s:13:"extra_indexed";N;s:5:"block";i:2774298;s:4:"time";s:19:"2024-03-18 20:38:08";s:8:"sort_key";i:5;}i:6;a:9:{s:11:"transaction";s:64:"97d3a20cb85209167de9ff354be7a6b7f10506db35a7ca5dfeae81cdfce73433";s:8:"currency";s:64:"6f0279e9ed041c3d710a9f57d0c02928416460c4b722ae3457a11eec381c526d";s:7:"address";s:42:"ex1qx7tzr5ztcex6f229z4pat96mpdvwadwf7r3stx";s:6:"effect";s:7:"1134017";s:5:"extra";N;s:13:"extra_indexed";N;s:5:"block";i:2774298;s:4:"time";s:19:"2024-03-18 20:38:08";s:8:"sort_key";i:6;}i:7;a:9:{s:11:"transaction";s:64:"97d3a20cb85209167de9ff354be7a6b7f10506db35a7ca5dfeae81cdfce73433";s:8:"currency";s:64:"6f0279e9ed041c3d710a9f57d0c02928416460c4b722ae3457a11eec381c526d";s:7:"address";s:8:"the-void";s:6:"effect";s:2:"60";s:5:"extra";N;s:13:"extra_indexed";N;s:5:"block";i:2774298;s:4:"time";s:19:"2024-03-18 20:38:08";s:8:"sort_key";i:7;}}s:10:"currencies";a:2:{i:0;a:4:{s:2:"id";s:64:"6f0279e9ed041c3d710a9f57d0c02928416460c4b722ae3457a11eec381c526d";s:4:"name";s:14:"Liquid Bitcoin";s:6:"symbol";s:5:"L-BTC";s:8:"decimals";i:8;}i:1;a:4:{s:2:"id";s:64:"71e30c59c03e78d064757befa459ae7a0e9c4b8a5ae16cc90b3d70fc73b40ce4";s:4:"name";s:26:"Taxkredit project 68cbc66a";s:6:"symbol";s:5:"tWaZe";s:8:"decimals";s:1:"2";}}}'],
            // With L-BTC only
            ['block' => 2766919, 'result' => 'a:2:{s:6:"events";a:13:{i:0;a:9:{s:11:"transaction";s:64:"4f6762c0a0c639b452fe5de2272cfa59348ca36580b83cc942838a580b55cbdc";s:8:"currency";s:64:"6f0279e9ed041c3d710a9f57d0c02928416460c4b722ae3457a11eec381c526d";s:7:"address";s:8:"the-void";s:6:"effect";s:4:"-446";s:5:"extra";N;s:13:"extra_indexed";N;s:5:"block";i:2766919;s:4:"time";s:19:"2024-03-13 14:45:08";s:8:"sort_key";i:0;}i:1;a:9:{s:11:"transaction";s:64:"4f6762c0a0c639b452fe5de2272cfa59348ca36580b83cc942838a580b55cbdc";s:8:"currency";s:64:"6f0279e9ed041c3d710a9f57d0c02928416460c4b722ae3457a11eec381c526d";s:7:"address";s:39:"script-efcb3e8b994fe44d9b6dd0b55ab213a0";s:6:"effect";s:1:"0";s:5:"extra";N;s:13:"extra_indexed";N;s:5:"block";i:2766919;s:4:"time";s:19:"2024-03-13 14:45:08";s:8:"sort_key";i:1;}i:2;a:9:{s:11:"transaction";s:64:"4f6762c0a0c639b452fe5de2272cfa59348ca36580b83cc942838a580b55cbdc";s:8:"currency";s:64:"6f0279e9ed041c3d710a9f57d0c02928416460c4b722ae3457a11eec381c526d";s:7:"address";s:34:"QLFdUboUPJnUzvsXKu83hUtrQ1DuxyggRg";s:6:"effect";s:3:"446";s:5:"extra";N;s:13:"extra_indexed";N;s:5:"block";i:2766919;s:4:"time";s:19:"2024-03-13 14:45:08";s:8:"sort_key";i:2;}i:3;a:9:{s:11:"transaction";s:64:"4f6762c0a0c639b452fe5de2272cfa59348ca36580b83cc942838a580b55cbdc";s:8:"currency";s:64:"6f0279e9ed041c3d710a9f57d0c02928416460c4b722ae3457a11eec381c526d";s:7:"address";s:39:"script-287938b14253c57813474cb5eaf51d63";s:6:"effect";s:1:"0";s:5:"extra";N;s:13:"extra_indexed";N;s:5:"block";i:2766919;s:4:"time";s:19:"2024-03-13 14:45:08";s:8:"sort_key";i:3;}i:4;a:9:{s:11:"transaction";s:64:"7a731e79ae494ce4540322ea17a700eb050e1026009d49effea59b6b4985975c";s:8:"currency";s:64:"6f0279e9ed041c3d710a9f57d0c02928416460c4b722ae3457a11eec381c526d";s:7:"address";s:42:"ex1qq2wh460mj56u5dunv8g9e4demrfa3sh723hums";s:6:"effect";s:2:"-?";s:5:"extra";N;s:13:"extra_indexed";N;s:5:"block";i:2766919;s:4:"time";s:19:"2024-03-13 14:45:08";s:8:"sort_key";i:4;}i:5;a:9:{s:11:"transaction";s:64:"7a731e79ae494ce4540322ea17a700eb050e1026009d49effea59b6b4985975c";s:8:"currency";s:64:"6f0279e9ed041c3d710a9f57d0c02928416460c4b722ae3457a11eec381c526d";s:7:"address";s:42:"ex1qn84sc3540g7v8qr4j0tdsfa6qlshzsn47rz3yh";s:6:"effect";s:2:"-?";s:5:"extra";N;s:13:"extra_indexed";N;s:5:"block";i:2766919;s:4:"time";s:19:"2024-03-13 14:45:08";s:8:"sort_key";i:5;}i:6;a:9:{s:11:"transaction";s:64:"7a731e79ae494ce4540322ea17a700eb050e1026009d49effea59b6b4985975c";s:8:"currency";s:64:"6f0279e9ed041c3d710a9f57d0c02928416460c4b722ae3457a11eec381c526d";s:7:"address";s:42:"ex1qwmyrwfm2fkcf82qmayhg22nh455ecyk4pqdp69";s:6:"effect";s:2:"-?";s:5:"extra";N;s:13:"extra_indexed";N;s:5:"block";i:2766919;s:4:"time";s:19:"2024-03-13 14:45:08";s:8:"sort_key";i:6;}i:7;a:9:{s:11:"transaction";s:64:"7a731e79ae494ce4540322ea17a700eb050e1026009d49effea59b6b4985975c";s:8:"currency";N;s:7:"address";s:62:"ex1qemcjtseyldmga7axcv4sfq4dz3vap96snpe70huyalv84hxmn8wsty4yuv";s:6:"effect";s:2:"+?";s:5:"extra";N;s:13:"extra_indexed";N;s:5:"block";i:2766919;s:4:"time";s:19:"2024-03-13 14:45:08";s:8:"sort_key";i:7;}i:8;a:9:{s:11:"transaction";s:64:"7a731e79ae494ce4540322ea17a700eb050e1026009d49effea59b6b4985975c";s:8:"currency";N;s:7:"address";s:42:"ex1qzhftnsrlr9x3vn9du9lgtqqllux2elpe2mva6w";s:6:"effect";s:2:"+?";s:5:"extra";N;s:13:"extra_indexed";N;s:5:"block";i:2766919;s:4:"time";s:19:"2024-03-13 14:45:08";s:8:"sort_key";i:8;}i:9;a:9:{s:11:"transaction";s:64:"7a731e79ae494ce4540322ea17a700eb050e1026009d49effea59b6b4985975c";s:8:"currency";s:64:"6f0279e9ed041c3d710a9f57d0c02928416460c4b722ae3457a11eec381c526d";s:7:"address";s:8:"the-void";s:6:"effect";s:3:"294";s:5:"extra";N;s:13:"extra_indexed";N;s:5:"block";i:2766919;s:4:"time";s:19:"2024-03-13 14:45:08";s:8:"sort_key";i:9;}i:10;a:9:{s:11:"transaction";s:64:"57b56f5b9ec72c95cf3431e1fe9e1ec528ebbbc4b59819fd701484fca5d43b88";s:8:"currency";s:64:"6f0279e9ed041c3d710a9f57d0c02928416460c4b722ae3457a11eec381c526d";s:7:"address";s:62:"ex1qemcjtseyldmga7axcv4sfq4dz3vap96snpe70huyalv84hxmn8wsty4yuv";s:6:"effect";s:2:"-?";s:5:"extra";N;s:13:"extra_indexed";N;s:5:"block";i:2766919;s:4:"time";s:19:"2024-03-13 14:45:08";s:8:"sort_key";i:10;}i:11;a:9:{s:11:"transaction";s:64:"57b56f5b9ec72c95cf3431e1fe9e1ec528ebbbc4b59819fd701484fca5d43b88";s:8:"currency";N;s:7:"address";s:34:"GteSSbj2k7EmNCXqnNnagGsTPVQ6S93N6n";s:6:"effect";s:2:"+?";s:5:"extra";N;s:13:"extra_indexed";N;s:5:"block";i:2766919;s:4:"time";s:19:"2024-03-13 14:45:08";s:8:"sort_key";i:11;}i:12;a:9:{s:11:"transaction";s:64:"57b56f5b9ec72c95cf3431e1fe9e1ec528ebbbc4b59819fd701484fca5d43b88";s:8:"currency";s:64:"6f0279e9ed041c3d710a9f57d0c02928416460c4b722ae3457a11eec381c526d";s:7:"address";s:8:"the-void";s:6:"effect";s:3:"152";s:5:"extra";N;s:13:"extra_indexed";N;s:5:"block";i:2766919;s:4:"time";s:19:"2024-03-13 14:45:08";s:8:"sort_key";i:12;}}s:10:"currencies";a:1:{i:0;a:4:{s:2:"id";s:64:"6f0279e9ed041c3d710a9f57d0c02928416460c4b722ae3457a11eec381c526d";s:4:"name";s:14:"Liquid Bitcoin";s:6:"symbol";s:5:"L-BTC";s:8:"decimals";i:8;}}}'],
            // With pegin
            ['block' => 2766423, 'result' => 'a:2:{s:6:"events";a:10:{i:0;a:9:{s:11:"transaction";s:64:"eac7bddebcc5c76b9bc548115c7e3144d6c6654abb4ab76227374816436a15e6";s:8:"currency";s:64:"6f0279e9ed041c3d710a9f57d0c02928416460c4b722ae3457a11eec381c526d";s:7:"address";s:8:"the-void";s:6:"effect";s:3:"-86";s:5:"extra";N;s:13:"extra_indexed";N;s:5:"block";i:2766423;s:4:"time";s:19:"2024-03-13 06:29:08";s:8:"sort_key";i:0;}i:1;a:9:{s:11:"transaction";s:64:"eac7bddebcc5c76b9bc548115c7e3144d6c6654abb4ab76227374816436a15e6";s:8:"currency";s:64:"6f0279e9ed041c3d710a9f57d0c02928416460c4b722ae3457a11eec381c526d";s:7:"address";s:39:"script-14b005d6cde92956f8acef08cd554ebd";s:6:"effect";s:1:"0";s:5:"extra";N;s:13:"extra_indexed";N;s:5:"block";i:2766423;s:4:"time";s:19:"2024-03-13 06:29:08";s:8:"sort_key";i:1;}i:2;a:9:{s:11:"transaction";s:64:"eac7bddebcc5c76b9bc548115c7e3144d6c6654abb4ab76227374816436a15e6";s:8:"currency";s:64:"6f0279e9ed041c3d710a9f57d0c02928416460c4b722ae3457a11eec381c526d";s:7:"address";s:34:"QLFdUboUPJnUzvsXKu83hUtrQ1DuxyggRg";s:6:"effect";s:2:"86";s:5:"extra";N;s:13:"extra_indexed";N;s:5:"block";i:2766423;s:4:"time";s:19:"2024-03-13 06:29:08";s:8:"sort_key";i:2;}i:3;a:9:{s:11:"transaction";s:64:"eac7bddebcc5c76b9bc548115c7e3144d6c6654abb4ab76227374816436a15e6";s:8:"currency";s:64:"6f0279e9ed041c3d710a9f57d0c02928416460c4b722ae3457a11eec381c526d";s:7:"address";s:39:"script-08be25e98319c0bfe137f3102fbc496c";s:6:"effect";s:1:"0";s:5:"extra";N;s:13:"extra_indexed";N;s:5:"block";i:2766423;s:4:"time";s:19:"2024-03-13 06:29:08";s:8:"sort_key";i:3;}i:4;a:9:{s:11:"transaction";s:64:"9d9209113c3ded3a1a9a28be5b1227206d94b49df8f3adbbb343002d2d90fe00";s:8:"currency";s:64:"6f0279e9ed041c3d710a9f57d0c02928416460c4b722ae3457a11eec381c526d";s:7:"address";s:7:"bitcoin";s:6:"effect";s:8:"-2497468";s:5:"extra";s:2:"pi";s:13:"extra_indexed";s:64:"e1efb6717354c548c981ed266922e045a85a0fe489df84f301364532f3306c49";s:5:"block";i:2766423;s:4:"time";s:19:"2024-03-13 06:29:08";s:8:"sort_key";i:4;}i:5;a:9:{s:11:"transaction";s:64:"9d9209113c3ded3a1a9a28be5b1227206d94b49df8f3adbbb343002d2d90fe00";s:8:"currency";s:64:"6f0279e9ed041c3d710a9f57d0c02928416460c4b722ae3457a11eec381c526d";s:7:"address";s:42:"ex1q4q240cjajpc2jy7kcs09zqsqh3xalfzeectgay";s:6:"effect";s:7:"2497468";s:5:"extra";N;s:13:"extra_indexed";N;s:5:"block";i:2766423;s:4:"time";s:19:"2024-03-13 06:29:08";s:8:"sort_key";i:5;}i:6;a:9:{s:11:"transaction";s:64:"9d9209113c3ded3a1a9a28be5b1227206d94b49df8f3adbbb343002d2d90fe00";s:8:"currency";s:64:"6f0279e9ed041c3d710a9f57d0c02928416460c4b722ae3457a11eec381c526d";s:7:"address";s:8:"the-void";s:6:"effect";s:2:"43";s:5:"extra";N;s:13:"extra_indexed";N;s:5:"block";i:2766423;s:4:"time";s:19:"2024-03-13 06:29:08";s:8:"sort_key";i:6;}i:7;a:9:{s:11:"transaction";s:64:"cf2e9f28f41e6a5ebdaee32c17123b36616283728d850842206b4204291717a5";s:8:"currency";s:64:"6f0279e9ed041c3d710a9f57d0c02928416460c4b722ae3457a11eec381c526d";s:7:"address";s:7:"bitcoin";s:6:"effect";s:8:"-1548364";s:5:"extra";s:2:"pi";s:13:"extra_indexed";s:64:"82e2d8f6bbe7d252c18e96f931033075d5eb0b5c79e0ed346eae6c024f40973d";s:5:"block";i:2766423;s:4:"time";s:19:"2024-03-13 06:29:08";s:8:"sort_key";i:7;}i:8;a:9:{s:11:"transaction";s:64:"cf2e9f28f41e6a5ebdaee32c17123b36616283728d850842206b4204291717a5";s:8:"currency";s:64:"6f0279e9ed041c3d710a9f57d0c02928416460c4b722ae3457a11eec381c526d";s:7:"address";s:42:"ex1qvtp03vtzeru6lff556xx7xssvm3a3mlzjtxdme";s:6:"effect";s:7:"1548364";s:5:"extra";N;s:13:"extra_indexed";N;s:5:"block";i:2766423;s:4:"time";s:19:"2024-03-13 06:29:08";s:8:"sort_key";i:8;}i:9;a:9:{s:11:"transaction";s:64:"cf2e9f28f41e6a5ebdaee32c17123b36616283728d850842206b4204291717a5";s:8:"currency";s:64:"6f0279e9ed041c3d710a9f57d0c02928416460c4b722ae3457a11eec381c526d";s:7:"address";s:8:"the-void";s:6:"effect";s:2:"43";s:5:"extra";N;s:13:"extra_indexed";N;s:5:"block";i:2766423;s:4:"time";s:19:"2024-03-13 06:29:08";s:8:"sort_key";i:9;}}s:10:"currencies";a:1:{i:0;a:4:{s:2:"id";s:64:"6f0279e9ed041c3d710a9f57d0c02928416460c4b722ae3457a11eec381c526d";s:4:"name";s:14:"Liquid Bitcoin";s:6:"symbol";s:5:"L-BTC";s:8:"decimals";i:8;}}}'],
        ];
    }
}
