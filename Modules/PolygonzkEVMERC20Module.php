<?php declare(strict_types = 1);

/*  Idea (c) 2023 Nikita Zhavoronkov, nikzh@nikzh.com
 *  Copyright (c) 2023 3xpl developers, 3@3xpl.com, see CONTRIBUTORS.md
 *  Distributed under the MIT software license, see LICENSE.md  */

/*  This module processes ERC-20 token transfers in Polygon zkEVM. It requires a geth node to run.  */

final class PolygonzkEVMERC20Module extends EVMERC20Module implements Module
{
    function initialize()
    {
        // CoreModule
        $this->blockchain = 'polygon-zkevm';
        $this->module = 'polygon-zkevm-erc-20';
        $this->is_main = false;
        $this->first_block_date = '2023-03-24';
        $this->first_block_id = 0;
        $this->mempool_implemented = true;

        // EVMTraceModule
        $this->extra_features = [EVMSpecialFeatures::zkEVM];

        // Tests
        $this->tests = [
            ['block' => 1992119, 'result' => 'a:2:{s:6:"events";a:24:{i:0;a:7:{s:11:"transaction";s:66:"0x6325276ff3f69b785fc4e5636760a1e1fbb620082fa9e1cab650064121de425d";s:8:"currency";s:42:"0x37eaa0ef3549a5bb7d431be78a3d99bd360d19e5";s:7:"address";s:42:"0x9432870492407e7e36c4a93c4183023b5c0390eb";s:8:"sort_key";i:0;s:6:"effect";s:4:"-732";s:5:"block";i:1992119;s:4:"time";s:19:"2024-02-23 09:07:47";}i:1;a:7:{s:11:"transaction";s:66:"0x6325276ff3f69b785fc4e5636760a1e1fbb620082fa9e1cab650064121de425d";s:8:"currency";s:42:"0x37eaa0ef3549a5bb7d431be78a3d99bd360d19e5";s:7:"address";s:42:"0xab7794ecd2c8e9decc6b577864b40ebf9204720f";s:8:"sort_key";i:1;s:6:"effect";s:3:"732";s:5:"block";i:1992119;s:4:"time";s:19:"2024-02-23 09:07:47";}i:2;a:7:{s:11:"transaction";s:66:"0x47d201f13f3b947bae8e3fc1283e788d6281b9887b1196e9753ab7e75a7e585a";s:8:"currency";s:42:"0x37eaa0ef3549a5bb7d431be78a3d99bd360d19e5";s:7:"address";s:42:"0xab7794ecd2c8e9decc6b577864b40ebf9204720f";s:8:"sort_key";i:2;s:6:"effect";s:5:"-5839";s:5:"block";i:1992119;s:4:"time";s:19:"2024-02-23 09:07:47";}i:3;a:7:{s:11:"transaction";s:66:"0x47d201f13f3b947bae8e3fc1283e788d6281b9887b1196e9753ab7e75a7e585a";s:8:"currency";s:42:"0x37eaa0ef3549a5bb7d431be78a3d99bd360d19e5";s:7:"address";s:42:"0xd80047f44303566d53462785c9783d51d2571f4f";s:8:"sort_key";i:3;s:6:"effect";s:4:"5839";s:5:"block";i:1992119;s:4:"time";s:19:"2024-02-23 09:07:47";}i:4;a:7:{s:11:"transaction";s:66:"0x47d201f13f3b947bae8e3fc1283e788d6281b9887b1196e9753ab7e75a7e585a";s:8:"currency";s:42:"0x37eaa0ef3549a5bb7d431be78a3d99bd360d19e5";s:7:"address";s:42:"0xab7794ecd2c8e9decc6b577864b40ebf9204720f";s:8:"sort_key";i:4;s:6:"effect";s:7:"-250000";s:5:"block";i:1992119;s:4:"time";s:19:"2024-02-23 09:07:47";}i:5;a:7:{s:11:"transaction";s:66:"0x47d201f13f3b947bae8e3fc1283e788d6281b9887b1196e9753ab7e75a7e585a";s:8:"currency";s:42:"0x37eaa0ef3549a5bb7d431be78a3d99bd360d19e5";s:7:"address";s:42:"0xf14af9b2bc43c37f78bd83b0fb954f2a3afc1d29";s:8:"sort_key";i:5;s:6:"effect";s:6:"250000";s:5:"block";i:1992119;s:4:"time";s:19:"2024-02-23 09:07:47";}i:6;a:7:{s:11:"transaction";s:66:"0x47d201f13f3b947bae8e3fc1283e788d6281b9887b1196e9753ab7e75a7e585a";s:8:"currency";s:42:"0x37eaa0ef3549a5bb7d431be78a3d99bd360d19e5";s:7:"address";s:42:"0xab7794ecd2c8e9decc6b577864b40ebf9204720f";s:8:"sort_key";i:6;s:6:"effect";s:8:"-2627157";s:5:"block";i:1992119;s:4:"time";s:19:"2024-02-23 09:07:47";}i:7;a:7:{s:11:"transaction";s:66:"0x47d201f13f3b947bae8e3fc1283e788d6281b9887b1196e9753ab7e75a7e585a";s:8:"currency";s:42:"0x37eaa0ef3549a5bb7d431be78a3d99bd360d19e5";s:7:"address";s:42:"0x9432870492407e7e36c4a93c4183023b5c0390eb";s:8:"sort_key";i:7;s:6:"effect";s:7:"2627157";s:5:"block";i:1992119;s:4:"time";s:19:"2024-02-23 09:07:47";}i:8;a:7:{s:11:"transaction";s:66:"0x47d201f13f3b947bae8e3fc1283e788d6281b9887b1196e9753ab7e75a7e585a";s:8:"currency";s:42:"0x37eaa0ef3549a5bb7d431be78a3d99bd360d19e5";s:7:"address";s:42:"0xab7794ecd2c8e9decc6b577864b40ebf9204720f";s:8:"sort_key";i:8;s:6:"effect";s:4:"-729";s:5:"block";i:1992119;s:4:"time";s:19:"2024-02-23 09:07:47";}i:9;a:7:{s:11:"transaction";s:66:"0x47d201f13f3b947bae8e3fc1283e788d6281b9887b1196e9753ab7e75a7e585a";s:8:"currency";s:42:"0x37eaa0ef3549a5bb7d431be78a3d99bd360d19e5";s:7:"address";s:42:"0x9432870492407e7e36c4a93c4183023b5c0390eb";s:8:"sort_key";i:9;s:6:"effect";s:3:"729";s:5:"block";i:1992119;s:4:"time";s:19:"2024-02-23 09:07:47";}i:10;a:7:{s:11:"transaction";s:66:"0x12edd9b78b278eef1d1f103200139f1db98f74bd27f0e5c418f06a65154f4389";s:8:"currency";s:42:"0x9cbd81b43ba263ca894178366cfb89a246d1159c";s:7:"address";s:42:"0xc9001aff3701e19c29e996d48e474baf4c5ed006";s:8:"sort_key";i:10;s:6:"effect";s:23:"-5931700358236477744776";s:5:"block";i:1992119;s:4:"time";s:19:"2024-02-23 09:07:47";}i:11;a:7:{s:11:"transaction";s:66:"0x12edd9b78b278eef1d1f103200139f1db98f74bd27f0e5c418f06a65154f4389";s:8:"currency";s:42:"0x9cbd81b43ba263ca894178366cfb89a246d1159c";s:7:"address";s:42:"0x793e29b89f4944b96d183a63fe55400e329e0216";s:8:"sort_key";i:11;s:6:"effect";s:22:"5931700358236477744776";s:5:"block";i:1992119;s:4:"time";s:19:"2024-02-23 09:07:47";}i:12;a:7:{s:11:"transaction";s:66:"0x12edd9b78b278eef1d1f103200139f1db98f74bd27f0e5c418f06a65154f4389";s:8:"currency";s:42:"0x9cbd81b43ba263ca894178366cfb89a246d1159c";s:7:"address";s:42:"0x5197a4630a584834c760df3891ff18d0ea25c0ef";s:8:"sort_key";i:12;s:6:"effect";s:22:"-276128778633395134690";s:5:"block";i:1992119;s:4:"time";s:19:"2024-02-23 09:07:47";}i:13;a:7:{s:11:"transaction";s:66:"0x12edd9b78b278eef1d1f103200139f1db98f74bd27f0e5c418f06a65154f4389";s:8:"currency";s:42:"0x9cbd81b43ba263ca894178366cfb89a246d1159c";s:7:"address";s:42:"0x793e29b89f4944b96d183a63fe55400e329e0216";s:8:"sort_key";i:13;s:6:"effect";s:21:"276128778633395134690";s:5:"block";i:1992119;s:4:"time";s:19:"2024-02-23 09:07:47";}i:14;a:7:{s:11:"transaction";s:66:"0x93508c1fef25f6fb5133507591afd39d56f131f1baee2e7ceecbad7044c431a6";s:8:"currency";s:42:"0xa8ce8aee21bc2a48a5ef670afcc9274c7bbbc035";s:7:"address";s:42:"0x0743f5845a5e5e6e71902544a7be4308de1be57d";s:8:"sort_key";i:14;s:6:"effect";s:10:"-122530037";s:5:"block";i:1992119;s:4:"time";s:19:"2024-02-23 09:07:47";}i:15;a:7:{s:11:"transaction";s:66:"0x93508c1fef25f6fb5133507591afd39d56f131f1baee2e7ceecbad7044c431a6";s:8:"currency";s:42:"0xa8ce8aee21bc2a48a5ef670afcc9274c7bbbc035";s:7:"address";s:42:"0xd4f3531fc95572d9e7b9e9328d9feaa8e8496054";s:8:"sort_key";i:15;s:6:"effect";s:9:"122530037";s:5:"block";i:1992119;s:4:"time";s:19:"2024-02-23 09:07:47";}i:16;a:7:{s:11:"transaction";s:66:"0x93508c1fef25f6fb5133507591afd39d56f131f1baee2e7ceecbad7044c431a6";s:8:"currency";s:42:"0x37eaa0ef3549a5bb7d431be78a3d99bd360d19e5";s:7:"address";s:42:"0x0000000000000000000000000000000000000000";s:8:"sort_key";i:16;s:6:"effect";s:10:"-122530037";s:5:"block";i:1992119;s:4:"time";s:19:"2024-02-23 09:07:47";}i:17;a:7:{s:11:"transaction";s:66:"0x93508c1fef25f6fb5133507591afd39d56f131f1baee2e7ceecbad7044c431a6";s:8:"currency";s:42:"0x37eaa0ef3549a5bb7d431be78a3d99bd360d19e5";s:7:"address";s:42:"0x0743f5845a5e5e6e71902544a7be4308de1be57d";s:8:"sort_key";i:17;s:6:"effect";s:9:"122530037";s:5:"block";i:1992119;s:4:"time";s:19:"2024-02-23 09:07:47";}i:18;a:7:{s:11:"transaction";s:66:"0x1dc831d479f3acb57616659644b58277947cedbf533db834779589eebe4e1cbb";s:8:"currency";s:42:"0x4f9a0e7fd2bf6067db6994cf12e4495df938e6e9";s:7:"address";s:42:"0xada6e69781399990d42becb1a9427955ffa73bdc";s:8:"sort_key";i:18;s:6:"effect";s:16:"-100000000000000";s:5:"block";i:1992119;s:4:"time";s:19:"2024-02-23 09:07:47";}i:19;a:7:{s:11:"transaction";s:66:"0x1dc831d479f3acb57616659644b58277947cedbf533db834779589eebe4e1cbb";s:8:"currency";s:42:"0x4f9a0e7fd2bf6067db6994cf12e4495df938e6e9";s:7:"address";s:42:"0xece7244a0e861c841651401fc22cee577fee90af";s:8:"sort_key";i:19;s:6:"effect";s:15:"100000000000000";s:5:"block";i:1992119;s:4:"time";s:19:"2024-02-23 09:07:47";}i:20;a:7:{s:11:"transaction";s:66:"0xaf69af92905438eab69232a979181adbcac539f48b58d7ded5cd7b3d95a51a02";s:8:"currency";s:42:"0xa8ce8aee21bc2a48a5ef670afcc9274c7bbbc035";s:7:"address";s:42:"0xc9001aff3701e19c29e996d48e474baf4c5ed006";s:8:"sort_key";i:20;s:6:"effect";s:11:"-1398877568";s:5:"block";i:1992119;s:4:"time";s:19:"2024-02-23 09:07:47";}i:21;a:7:{s:11:"transaction";s:66:"0xaf69af92905438eab69232a979181adbcac539f48b58d7ded5cd7b3d95a51a02";s:8:"currency";s:42:"0xa8ce8aee21bc2a48a5ef670afcc9274c7bbbc035";s:7:"address";s:42:"0x793e29b89f4944b96d183a63fe55400e329e0216";s:8:"sort_key";i:21;s:6:"effect";s:10:"1398877568";s:5:"block";i:1992119;s:4:"time";s:19:"2024-02-23 09:07:47";}i:22;a:7:{s:11:"transaction";s:66:"0xaf69af92905438eab69232a979181adbcac539f48b58d7ded5cd7b3d95a51a02";s:8:"currency";s:42:"0x9cbd81b43ba263ca894178366cfb89a246d1159c";s:7:"address";s:42:"0x5197a4630a584834c760df3891ff18d0ea25c0ef";s:8:"sort_key";i:22;s:6:"effect";s:22:"-515847160060890618958";s:5:"block";i:1992119;s:4:"time";s:19:"2024-02-23 09:07:47";}i:23;a:7:{s:11:"transaction";s:66:"0xaf69af92905438eab69232a979181adbcac539f48b58d7ded5cd7b3d95a51a02";s:8:"currency";s:42:"0x9cbd81b43ba263ca894178366cfb89a246d1159c";s:7:"address";s:42:"0x793e29b89f4944b96d183a63fe55400e329e0216";s:8:"sort_key";i:23;s:6:"effect";s:21:"515847160060890618958";s:5:"block";i:1992119;s:4:"time";s:19:"2024-02-23 09:07:47";}}s:10:"currencies";a:4:{i:0;a:4:{s:2:"id";s:42:"0x37eaa0ef3549a5bb7d431be78a3d99bd360d19e5";s:4:"name";s:8:"USD Coin";s:6:"symbol";s:4:"USDC";s:8:"decimals";i:6;}i:1;a:4:{s:2:"id";s:42:"0x9cbd81b43ba263ca894178366cfb89a246d1159c";s:4:"name";s:12:"Dyson Sphere";s:6:"symbol";s:4:"DYSN";s:8:"decimals";i:18;}i:2;a:4:{s:2:"id";s:42:"0xa8ce8aee21bc2a48a5ef670afcc9274c7bbbc035";s:4:"name";s:8:"USD Coin";s:6:"symbol";s:4:"USDC";s:8:"decimals";i:6;}i:3;a:4:{s:2:"id";s:42:"0x4f9a0e7fd2bf6067db6994cf12e4495df938e6e9";s:4:"name";s:13:"Wrapped Ether";s:6:"symbol";s:4:"WETH";s:8:"decimals";i:18;}}}'],
        ];
    }
}
