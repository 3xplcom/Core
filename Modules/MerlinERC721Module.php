<?php declare(strict_types = 1);

/*  Idea (c) 2023 Nikita Zhavoronkov, nikzh@nikzh.com
 *  Copyright (c) 2023-2024 3xpl developers, 3@3xpl.com, see CONTRIBUTORS.md
 *  Distributed under the MIT software license, see LICENSE.md  */

/*  This module processes ERC-721 NFT transfers in Merlin. It requires a geth node to run.  */

final class MerlinERC721Module extends EVMERC721Module implements Module, MultipleBalanceSpecial
{
    function initialize()
    {
        // CoreModule
        $this->blockchain = 'merlin';
        $this->module = 'merlin-erc-721';
        $this->is_main = false;
        $this->first_block_date = '2024-02-02';
        $this->first_block_id = 0;

        $this->extra_features = [EVMSpecialFeatures::zkEVM];

        $this->tests = [
            ['block' => 1546385, 'result' => 'a:2:{s:6:"events";a:14:{i:0;a:8:{s:11:"transaction";s:66:"0x63ff2d02067f6fb8adad2411d18196c4ae140d765dc5f1a36a99ce4ccb8b9ea9";s:8:"currency";s:42:"0xd32e14cc9aa5413622fd00b28e50adfbf25c7ef8";s:7:"address";s:42:"0x0000000000000000000000000000000000000000";s:8:"sort_key";i:0;s:6:"effect";s:2:"-1";s:5:"extra";s:4:"8259";s:5:"block";i:1546385;s:4:"time";s:19:"2024-05-15 08:10:28";}i:1;a:8:{s:11:"transaction";s:66:"0x63ff2d02067f6fb8adad2411d18196c4ae140d765dc5f1a36a99ce4ccb8b9ea9";s:8:"currency";s:42:"0xd32e14cc9aa5413622fd00b28e50adfbf25c7ef8";s:7:"address";s:42:"0xc72ad28e8fdeaa23e05da938b3309d85e3121745";s:8:"sort_key";i:1;s:6:"effect";s:1:"1";s:5:"extra";s:4:"8259";s:5:"block";i:1546385;s:4:"time";s:19:"2024-05-15 08:10:28";}i:2;a:8:{s:11:"transaction";s:66:"0x63ff2d02067f6fb8adad2411d18196c4ae140d765dc5f1a36a99ce4ccb8b9ea9";s:8:"currency";s:42:"0xd32e14cc9aa5413622fd00b28e50adfbf25c7ef8";s:7:"address";s:42:"0x0000000000000000000000000000000000000000";s:8:"sort_key";i:2;s:6:"effect";s:2:"-1";s:5:"extra";s:4:"9892";s:5:"block";i:1546385;s:4:"time";s:19:"2024-05-15 08:10:28";}i:3;a:8:{s:11:"transaction";s:66:"0x63ff2d02067f6fb8adad2411d18196c4ae140d765dc5f1a36a99ce4ccb8b9ea9";s:8:"currency";s:42:"0xd32e14cc9aa5413622fd00b28e50adfbf25c7ef8";s:7:"address";s:42:"0xc72ad28e8fdeaa23e05da938b3309d85e3121745";s:8:"sort_key";i:3;s:6:"effect";s:1:"1";s:5:"extra";s:4:"9892";s:5:"block";i:1546385;s:4:"time";s:19:"2024-05-15 08:10:28";}i:4;a:8:{s:11:"transaction";s:66:"0x63ff2d02067f6fb8adad2411d18196c4ae140d765dc5f1a36a99ce4ccb8b9ea9";s:8:"currency";s:42:"0xd32e14cc9aa5413622fd00b28e50adfbf25c7ef8";s:7:"address";s:42:"0x0000000000000000000000000000000000000000";s:8:"sort_key";i:4;s:6:"effect";s:2:"-1";s:5:"extra";s:4:"9917";s:5:"block";i:1546385;s:4:"time";s:19:"2024-05-15 08:10:28";}i:5;a:8:{s:11:"transaction";s:66:"0x63ff2d02067f6fb8adad2411d18196c4ae140d765dc5f1a36a99ce4ccb8b9ea9";s:8:"currency";s:42:"0xd32e14cc9aa5413622fd00b28e50adfbf25c7ef8";s:7:"address";s:42:"0xc72ad28e8fdeaa23e05da938b3309d85e3121745";s:8:"sort_key";i:5;s:6:"effect";s:1:"1";s:5:"extra";s:4:"9917";s:5:"block";i:1546385;s:4:"time";s:19:"2024-05-15 08:10:28";}i:6;a:8:{s:11:"transaction";s:66:"0x42e1c312f6369805c47b48309fa4447a0844ca4322373f1ea6946a4573fd8564";s:8:"currency";s:42:"0x1eb48c61402502c655e6a59b30e9f1c93121f701";s:7:"address";s:42:"0x0000000000000000000000000000000000000000";s:8:"sort_key";i:6;s:6:"effect";s:2:"-1";s:5:"extra";s:5:"13565";s:5:"block";i:1546385;s:4:"time";s:19:"2024-05-15 08:10:28";}i:7;a:8:{s:11:"transaction";s:66:"0x42e1c312f6369805c47b48309fa4447a0844ca4322373f1ea6946a4573fd8564";s:8:"currency";s:42:"0x1eb48c61402502c655e6a59b30e9f1c93121f701";s:7:"address";s:42:"0xc72ad28e8fdeaa23e05da938b3309d85e3121745";s:8:"sort_key";i:7;s:6:"effect";s:1:"1";s:5:"extra";s:5:"13565";s:5:"block";i:1546385;s:4:"time";s:19:"2024-05-15 08:10:28";}i:8;a:8:{s:11:"transaction";s:66:"0x42e1c312f6369805c47b48309fa4447a0844ca4322373f1ea6946a4573fd8564";s:8:"currency";s:42:"0x1eb48c61402502c655e6a59b30e9f1c93121f701";s:7:"address";s:42:"0x0000000000000000000000000000000000000000";s:8:"sort_key";i:8;s:6:"effect";s:2:"-1";s:5:"extra";s:4:"4009";s:5:"block";i:1546385;s:4:"time";s:19:"2024-05-15 08:10:28";}i:9;a:8:{s:11:"transaction";s:66:"0x42e1c312f6369805c47b48309fa4447a0844ca4322373f1ea6946a4573fd8564";s:8:"currency";s:42:"0x1eb48c61402502c655e6a59b30e9f1c93121f701";s:7:"address";s:42:"0xc72ad28e8fdeaa23e05da938b3309d85e3121745";s:8:"sort_key";i:9;s:6:"effect";s:1:"1";s:5:"extra";s:4:"4009";s:5:"block";i:1546385;s:4:"time";s:19:"2024-05-15 08:10:28";}i:10;a:8:{s:11:"transaction";s:66:"0x42e1c312f6369805c47b48309fa4447a0844ca4322373f1ea6946a4573fd8564";s:8:"currency";s:42:"0x1eb48c61402502c655e6a59b30e9f1c93121f701";s:7:"address";s:42:"0x0000000000000000000000000000000000000000";s:8:"sort_key";i:10;s:6:"effect";s:2:"-1";s:5:"extra";s:5:"32069";s:5:"block";i:1546385;s:4:"time";s:19:"2024-05-15 08:10:28";}i:11;a:8:{s:11:"transaction";s:66:"0x42e1c312f6369805c47b48309fa4447a0844ca4322373f1ea6946a4573fd8564";s:8:"currency";s:42:"0x1eb48c61402502c655e6a59b30e9f1c93121f701";s:7:"address";s:42:"0xc72ad28e8fdeaa23e05da938b3309d85e3121745";s:8:"sort_key";i:11;s:6:"effect";s:1:"1";s:5:"extra";s:5:"32069";s:5:"block";i:1546385;s:4:"time";s:19:"2024-05-15 08:10:28";}i:12;a:8:{s:11:"transaction";s:66:"0x42e1c312f6369805c47b48309fa4447a0844ca4322373f1ea6946a4573fd8564";s:8:"currency";s:42:"0x1eb48c61402502c655e6a59b30e9f1c93121f701";s:7:"address";s:42:"0x0000000000000000000000000000000000000000";s:8:"sort_key";i:12;s:6:"effect";s:2:"-1";s:5:"extra";s:5:"32070";s:5:"block";i:1546385;s:4:"time";s:19:"2024-05-15 08:10:28";}i:13;a:8:{s:11:"transaction";s:66:"0x42e1c312f6369805c47b48309fa4447a0844ca4322373f1ea6946a4573fd8564";s:8:"currency";s:42:"0x1eb48c61402502c655e6a59b30e9f1c93121f701";s:7:"address";s:42:"0xc72ad28e8fdeaa23e05da938b3309d85e3121745";s:8:"sort_key";i:13;s:6:"effect";s:1:"1";s:5:"extra";s:5:"32070";s:5:"block";i:1546385;s:4:"time";s:19:"2024-05-15 08:10:28";}}s:10:"currencies";a:2:{i:0;a:3:{s:2:"id";s:42:"0xd32e14cc9aa5413622fd00b28e50adfbf25c7ef8";s:4:"name";s:21:"Merlin\'s Seal BRC-420";s:6:"symbol";s:9:"M-BRC-420";}i:1;a:3:{s:2:"id";s:42:"0x1eb48c61402502c655e6a59b30e9f1c93121f701";s:4:"name";s:2:"Ts";s:6:"symbol";s:22:"M-This song about NFTs";}}}'],
        ];
    }
}
