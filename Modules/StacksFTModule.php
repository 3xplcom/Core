<?php declare(strict_types = 1);

/*  Idea (c) 2023 Nikita Zhavoronkov, nikzh@nikzh.com
 *  Copyright (c) 2023-2024 3xpl developers, 3@3xpl.com
 *  Distributed under the MIT software license, see the accompanying file LICENSE.md  */

 /*  This module processes FT Stacks transfers.  */
final class StacksFTModule extends StacksLikeFTModule implements Module, MultipleBalanceSpecial
{
    function initialize()
    {
        // CoreModule
        $this->blockchain = 'stacks';
        $this->module = 'stacks-ft';
        $this->is_main = false;
        $this->first_block_date = '2021-01-14';
        $this->first_block_id = 1;
        $this->token_api = false; // on false it uses Stacks node, on true -- token API by Hiro which is inconsistent 

        $this->tests = [
            ['block' => 289295, 'result' => 'a:2:{s:6:"events";a:2:{i:0;a:8:{s:11:"transaction";s:66:"0x05549a6b3c9329346fd0e2639631b8ecd2cda5d206895baa42ecd3348a318ad6";s:7:"address";s:57:"SP102V8P0F7JX67ARQ77WEA3D3CFB5XW39REDT0AM.amm-vault-v2-01";s:8:"currency";s:52:"SP102V8P0F7JX67ARQ77WEA3D3CFB5XW39REDT0AM.token-alex";s:8:"sort_key";i:0;s:6:"effect";s:12:"-86063186607";s:6:"failed";s:1:"f";s:5:"block";i:289295;s:4:"time";s:19:"2024-12-03 15:12:31";}i:1;a:8:{s:11:"transaction";s:66:"0x05549a6b3c9329346fd0e2639631b8ecd2cda5d206895baa42ecd3348a318ad6";s:7:"address";s:41:"SP3V49RD5EPQ7DVPH10VX1QABQ7KJBN48B2CGV0HR";s:8:"currency";s:52:"SP102V8P0F7JX67ARQ77WEA3D3CFB5XW39REDT0AM.token-alex";s:8:"sort_key";i:1;s:6:"effect";s:11:"86063186607";s:6:"failed";s:1:"f";s:5:"block";i:289295;s:4:"time";s:19:"2024-12-03 15:12:31";}}s:10:"currencies";a:1:{i:0;a:4:{s:2:"id";s:52:"SP102V8P0F7JX67ARQ77WEA3D3CFB5XW39REDT0AM.token-alex";s:8:"decimals";i:8;s:4:"name";s:10:"ALEX Token";s:6:"symbol";s:4:"ALEX";}}}'],
            ['block' => 169234, 'result' => 'a:2:{s:6:"events";a:12:{i:0;a:8:{s:11:"transaction";s:66:"0xc7693a66aefbb79d566a64a39c674c542f8c0a21517cfcee36a2064d52e7805d";s:7:"address";s:57:"SP102V8P0F7JX67ARQ77WEA3D3CFB5XW39REDT0AM.amm-vault-v2-01";s:8:"currency";s:52:"SP2XD7417HGPRTREMKF748VNEQPDRR0RMANB7X1NK.token-abtc";s:8:"sort_key";i:0;s:6:"effect";s:8:"-5570776";s:6:"failed";s:1:"f";s:5:"block";i:169234;s:4:"time";s:19:"2024-10-10 08:04:06";}i:1;a:8:{s:11:"transaction";s:66:"0xc7693a66aefbb79d566a64a39c674c542f8c0a21517cfcee36a2064d52e7805d";s:7:"address";s:41:"SP2J1K2BX0HNTP8JEZ23MR3Z38JFPQA49X0BJ45AF";s:8:"currency";s:52:"SP2XD7417HGPRTREMKF748VNEQPDRR0RMANB7X1NK.token-abtc";s:8:"sort_key";i:1;s:6:"effect";s:7:"5570776";s:6:"failed";s:1:"f";s:5:"block";i:169234;s:4:"time";s:19:"2024-10-10 08:04:06";}i:2;a:8:{s:11:"transaction";s:66:"0xf90760aa13a5b8819c7f083162ba7b8bacef99a94507357685e311421aba9b1b";s:7:"address";s:57:"SP102V8P0F7JX67ARQ77WEA3D3CFB5XW39REDT0AM.amm-vault-v2-01";s:8:"currency";s:62:"SP3NE50GEXFG9SZGTT51P40X2CKYSZ5CC4ZTZ7A2G.welshcorgicoin-token";s:8:"sort_key";i:2;s:6:"effect";s:11:"-6797710484";s:6:"failed";s:1:"f";s:5:"block";i:169234;s:4:"time";s:19:"2024-10-10 08:04:06";}i:3;a:8:{s:11:"transaction";s:66:"0xf90760aa13a5b8819c7f083162ba7b8bacef99a94507357685e311421aba9b1b";s:7:"address";s:41:"SP1DY3DQMVAA1F8JJAJBKPQ0HKQ1FZG67JG0YD5P3";s:8:"currency";s:62:"SP3NE50GEXFG9SZGTT51P40X2CKYSZ5CC4ZTZ7A2G.welshcorgicoin-token";s:8:"sort_key";i:3;s:6:"effect";s:10:"6797710484";s:6:"failed";s:1:"f";s:5:"block";i:169234;s:4:"time";s:19:"2024-10-10 08:04:06";}i:4;a:8:{s:11:"transaction";s:66:"0x3fec9148f0cc0297f928a1cdc512d441c6e00334120bc964b7bf35067ded11ac";s:7:"address";s:66:"SP25K3XPVBNWXPMYDXBPSZHGC8APW0Z21CWJ3Y3B1.wen-nakamoto-stxcity-dex";s:8:"currency";s:62:"SP25K3XPVBNWXPMYDXBPSZHGC8APW0Z21CWJ3Y3B1.wen-nakamoto-stxcity";s:8:"sort_key";i:4;s:6:"effect";s:12:"-91906903237";s:6:"failed";s:1:"f";s:5:"block";i:169234;s:4:"time";s:19:"2024-10-10 08:04:06";}i:5;a:8:{s:11:"transaction";s:66:"0x3fec9148f0cc0297f928a1cdc512d441c6e00334120bc964b7bf35067ded11ac";s:7:"address";s:41:"SP33QYJHG988R7XD10B5MPKG7NCWQJ77ETKMA2HK4";s:8:"currency";s:62:"SP25K3XPVBNWXPMYDXBPSZHGC8APW0Z21CWJ3Y3B1.wen-nakamoto-stxcity";s:8:"sort_key";i:5;s:6:"effect";s:11:"91906903237";s:6:"failed";s:1:"f";s:5:"block";i:169234;s:4:"time";s:19:"2024-10-10 08:04:06";}i:6;a:8:{s:11:"transaction";s:66:"0xd052ed6c08ee8ea383f4b4727c570473dfd8335d625cf9a7b5960557f5de71ba";s:7:"address";s:60:"SPARHENQD3QXG6VTHPNQBXSA72508JZZA4NW7VNG.seedoil-stxcity-dex";s:8:"currency";s:56:"SPARHENQD3QXG6VTHPNQBXSA72508JZZA4NW7VNG.seedoil-stxcity";s:8:"sort_key";i:6;s:6:"effect";s:14:"-2119920537162";s:6:"failed";s:1:"f";s:5:"block";i:169234;s:4:"time";s:19:"2024-10-10 08:04:06";}i:7;a:8:{s:11:"transaction";s:66:"0xd052ed6c08ee8ea383f4b4727c570473dfd8335d625cf9a7b5960557f5de71ba";s:7:"address";s:41:"SP33QYJHG988R7XD10B5MPKG7NCWQJ77ETKMA2HK4";s:8:"currency";s:56:"SPARHENQD3QXG6VTHPNQBXSA72508JZZA4NW7VNG.seedoil-stxcity";s:8:"sort_key";i:7;s:6:"effect";s:13:"2119920537162";s:6:"failed";s:1:"f";s:5:"block";i:169234;s:4:"time";s:19:"2024-10-10 08:04:06";}i:8;a:8:{s:11:"transaction";s:66:"0x9279f953252c336114838f558d1398f602d9d94b78f974849e4bca75682c0b1f";s:7:"address";s:66:"SP2XNCG1PE6X2QAHWM11QKBQZJKN7EMS2HZKP9QHE.stacks-mouse-stxcity-dex";s:8:"currency";s:62:"SP2XNCG1PE6X2QAHWM11QKBQZJKN7EMS2HZKP9QHE.stacks-mouse-stxcity";s:8:"sort_key";i:8;s:6:"effect";s:12:"-88137922891";s:6:"failed";s:1:"f";s:5:"block";i:169234;s:4:"time";s:19:"2024-10-10 08:04:06";}i:9;a:8:{s:11:"transaction";s:66:"0x9279f953252c336114838f558d1398f602d9d94b78f974849e4bca75682c0b1f";s:7:"address";s:41:"SP33QYJHG988R7XD10B5MPKG7NCWQJ77ETKMA2HK4";s:8:"currency";s:62:"SP2XNCG1PE6X2QAHWM11QKBQZJKN7EMS2HZKP9QHE.stacks-mouse-stxcity";s:8:"sort_key";i:9;s:6:"effect";s:11:"88137922891";s:6:"failed";s:1:"f";s:5:"block";i:169234;s:4:"time";s:19:"2024-10-10 08:04:06";}i:10;a:8:{s:11:"transaction";s:66:"0xb9e980485199208bb920d690d63596648ff3e36deadd3be272b5785fa2ea011d";s:7:"address";s:41:"SP31TAM0T6NMVKHVFYJXKYQ09S671RDC2NPAD2HYA";s:8:"currency";s:65:"SPSCWDV3RKV5ZRN1FQD84YE1NQFEDJ9R1F4DYQ11.newyorkcitycoin-token-v2";s:8:"sort_key";i:10;s:6:"effect";s:11:"-8750000000";s:6:"failed";s:1:"f";s:5:"block";i:169234;s:4:"time";s:19:"2024-10-10 08:04:06";}i:11;a:8:{s:11:"transaction";s:66:"0xb9e980485199208bb920d690d63596648ff3e36deadd3be272b5785fa2ea011d";s:7:"address";s:57:"SP102V8P0F7JX67ARQ77WEA3D3CFB5XW39REDT0AM.amm-vault-v2-01";s:8:"currency";s:65:"SPSCWDV3RKV5ZRN1FQD84YE1NQFEDJ9R1F4DYQ11.newyorkcitycoin-token-v2";s:8:"sort_key";i:11;s:6:"effect";s:10:"8750000000";s:6:"failed";s:1:"f";s:5:"block";i:169234;s:4:"time";s:19:"2024-10-10 08:04:06";}}s:10:"currencies";a:6:{i:0;a:4:{s:2:"id";s:52:"SP2XD7417HGPRTREMKF748VNEQPDRR0RMANB7X1NK.token-abtc";s:8:"decimals";i:8;s:4:"name";s:4:"aBTC";s:6:"symbol";s:4:"aBTC";}i:1;a:4:{s:2:"id";s:62:"SP3NE50GEXFG9SZGTT51P40X2CKYSZ5CC4ZTZ7A2G.welshcorgicoin-token";s:8:"decimals";i:6;s:4:"name";s:14:"Welshcorgicoin";s:6:"symbol";s:5:"WELSH";}i:2;a:4:{s:2:"id";s:62:"SP25K3XPVBNWXPMYDXBPSZHGC8APW0Z21CWJ3Y3B1.wen-nakamoto-stxcity";s:8:"decimals";i:6;s:4:"name";s:12:"WEN NAKAMOTO";s:6:"symbol";s:3:"WEN";}i:3;a:4:{s:2:"id";s:56:"SPARHENQD3QXG6VTHPNQBXSA72508JZZA4NW7VNG.seedoil-stxcity";s:8:"decimals";i:6;s:4:"name";s:7:"SeedOil";s:6:"symbol";s:4:"SOIL";}i:4;a:4:{s:2:"id";s:62:"SP2XNCG1PE6X2QAHWM11QKBQZJKN7EMS2HZKP9QHE.stacks-mouse-stxcity";s:8:"decimals";i:6;s:4:"name";s:12:"Stacks mouse";s:6:"symbol";s:8:"Stxmouse";}i:5;a:4:{s:2:"id";s:65:"SPSCWDV3RKV5ZRN1FQD84YE1NQFEDJ9R1F4DYQ11.newyorkcitycoin-token-v2";s:8:"decimals";i:6;s:4:"name";s:15:"newyorkcitycoin";s:6:"symbol";s:3:"NYC";}}}'],
        ];
    }
}
